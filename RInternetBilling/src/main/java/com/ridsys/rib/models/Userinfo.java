package com.ridsys.rib.models;

import java.math.BigInteger;

import javax.persistence.ColumnResult;
import javax.persistence.ConstructorResult;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.NamedNativeQuery;
import javax.persistence.SqlResultSetMapping;
import javax.persistence.Table;
import javax.validation.constraints.Email;
import javax.validation.constraints.NotEmpty;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

import com.fasterxml.jackson.annotation.JsonFormat;
import com.ridsys.rib.DTO.UserListDTO;
import com.ridsys.rib.DTO.UserStatusDTO;
import com.ridsys.rib.DTO.UserProfileInfoDTO;

@Entity
@Table(name = "userinfo")
@NamedNativeQuery(name = "Userinfo.getUserInfoWithCurrentStatusByUsername", query = "SELECT ui.*,op.username as lcousername,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planName,ubi.planid,ubi.quotaexpirydate,CONCAT(op.firstname,' ',op.lastname) AS opname,op.phone1 AS opphone,op.email1 AS opemail,op.title AS optitle,op.department AS opdepartment,op.company AS opcompany,ubi.address as billingaddress,ubi.zip as billzipcode,ubi.state as billingstate,ubi.city as billingcity,if(oui.username is null,'false','true')AS isott,concat('http://',(SELECT linkurl FROM clientinfo WHERE isdelete=0 LIMIT 1),'/RCRMPACKAGE/user-proofimage/',ui.username,'/',ui.userproofimage1) AS userproofimage FROM userinfo ui INNER JOIN userbillinfo ubi ON ubi.username=ui.username AND ui.username=:username INNER JOIN operators op ON op.id=ui.opid LEFT JOIN ottuserinfo oui ON oui.username=ui.username", resultSetMapping = "Mapping.UserProfileInfoDTO")
@SqlResultSetMapping(name = "Mapping.UserProfileInfoDTO", classes = {
		@ConstructorResult(targetClass = UserProfileInfoDTO.class, columns = { @ColumnResult(name = "id"),
				@ColumnResult(name = "username"), @ColumnResult(name = "password"), @ColumnResult(name = "firstname"),
				@ColumnResult(name = "lastname"), @ColumnResult(name = "email"), @ColumnResult(name = "department"),
				@ColumnResult(name = "company"), @ColumnResult(name = "workphone"), @ColumnResult(name = "homephone"),
				@ColumnResult(name = "mobilephone"), @ColumnResult(name = "address"), @ColumnResult(name = "city"),
				@ColumnResult(name = "state"), @ColumnResult(name = "country"), @ColumnResult(name = "zip"),
				@ColumnResult(name = "notes"), @ColumnResult(name = "changeuserinfo"),
				@ColumnResult(name = "portalloginpassword"), @ColumnResult(name = "enableportallogin"),
				@ColumnResult(name = "verificationstatus"), @ColumnResult(name = "userproofimage"),
				@ColumnResult(name = "olttype"), @ColumnResult(name = "ponout"), @ColumnResult(name = "userdevice"),
				@ColumnResult(name = "macaddress"), @ColumnResult(name = "creationdate", type = String.class),
				@ColumnResult(name = "updatedate", type = String.class), @ColumnResult(name = "creationby"),
				@ColumnResult(name = "updateby"), @ColumnResult(name = "opid"), @ColumnResult(name = "planname"),
				@ColumnResult(name = "planid"), @ColumnResult(name = "quotaexpirydate", type = String.class),
				@ColumnResult(name = "opname"), @ColumnResult(name = "opphone"), @ColumnResult(name = "opemail"),
				@ColumnResult(name = "optitle"), @ColumnResult(name = "opdepartment"),
				@ColumnResult(name = "opcompany"), @ColumnResult(name = "walletbalance"),
				@ColumnResult(name = "expstatus", type = Boolean.class), @ColumnResult(name = "billingaddress"),
				@ColumnResult(name = "billzipcode"), @ColumnResult(name = "billingstate"),
				@ColumnResult(name = "billingcity"), @ColumnResult(name = "isott", type = String.class),
				@ColumnResult(name = "lcousername", type = String.class),
				@ColumnResult(name = "deviceno", type = String.class) }) })

//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAll", query = "SELECT DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen, if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false) as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total  FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username  LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 ORDER BY ui.creationdate ", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllFtdate", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false) as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total  FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username    LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 and date(ui.creationdate)>=:fdate and date(ui.creationdate)<=:tdate  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllByOpid", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username  LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=?1  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllByOpidFtdate", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.usernameLEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=:opid and date(ui.creationdate)>=:fdate and date(ui.creationdate)<=:tdate ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNotExp", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen, if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid>0  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNotExpByOpid", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOffline", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ra.username=ui.username and ui.is_delete=0 and ustatus is null and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOfflineByOpid", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ustatus is null and ui.opid=?1 AND ra.username=ui.username ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")

//datausagebyperiod
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAll", query = "SELECT DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen, if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false) as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total  FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username  LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 ORDER BY ui.creationdate ", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllFtdate", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false) as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total  FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username    LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 and date(ui.creationdate)>=:fdate and date(ui.creationdate)<=:tdate  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllByOpid", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username  LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=?1  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllByOpidFtdate", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.usernameLEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=:opid and date(ui.creationdate)>=:fdate and date(ui.creationdate)<=:tdate ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNotExp", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen, if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid>0  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNotExpByOpid", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOffline", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ra.username=ui.username and ui.is_delete=0 and ustatus is null and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOfflineByOpid", query = "SELECT  DISTINCT ui.id,rp.fromip,rp.framedipaddress,ui.userdevice,ui.deviceno,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,  if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate,if(dubp.GB_in is null,0,dubp.GB_in)as GB_in,if(dubp.GB_out is null,0,dubp.GB_out)as GB_out,if(dubp.GB_total is null,0,dubp.GB_total)as GB_total FROM   (select*from radacct group by username) ra RIGHT JOIN userinfo ui ON ui.username=ra.username LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username left join ( SELECT d.username,period_start, round(SUM(acctinputoctets)/1000/1000/1000,2) AS GB_in, round(SUM(acctoutputoctets)/1000/1000/1000,2) AS GB_out,round((SUM(acctinputoctets)/1000/1000/1000)+(SUM(acctoutputoctets)/1000/1000/1000),2)  AS GB_total FROM  data_usage_by_period d left join userbillinfo ubi on ubi.username=d.username WHERE period_end IS NOT NULL and date(period_start)>=date(quotastartdate) GROUP by username ) dubp on dubp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ustatus is null and ui.opid=?1 AND ra.username=ui.username ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
@SqlResultSetMapping(name = "Mapping.UserListRS", classes = {
		@ConstructorResult(targetClass = UserListDTO.class, columns = { @ColumnResult(name = "id"),
				@ColumnResult(name = "planid", type = Integer.class), @ColumnResult(name = "quotaexpirydate"),
				@ColumnResult(name = "fullname"), @ColumnResult(name = "username"), @ColumnResult(name = "password"),
				@ColumnResult(name = "email"), @ColumnResult(name = "mobilephone"), @ColumnResult(name = "mac"),
				@ColumnResult(name = "ip"), @ColumnResult(name = "nasip"), @ColumnResult(name = "planName"),
				@ColumnResult(name = "ustatus"), @ColumnResult(name = "verificationstatus"),
				@ColumnResult(name = "expstatus", type = Boolean.class), @ColumnResult(name = "quotastartdate"),
				@ColumnResult(name = "lconame"), @ColumnResult(name = "lcoid", type = Integer.class),
				@ColumnResult(name = "vlanid", type = Integer.class), @ColumnResult(name = "planDays"),
				@ColumnResult(name = "isott", type = String.class),
				@ColumnResult(name = "ottplanActive", type = boolean.class), @ColumnResult(name = "ottplanexpirydate"),
				@ColumnResult(name = "ottplanactivedate"), @ColumnResult(name = "poolType"),
				@ColumnResult(name = "lastseen", type = String.class),
				@ColumnResult(name = "discountDays", type = String.class),
				@ColumnResult(name = "isiptv", type = String.class), @ColumnResult(name = "GB_in", type = String.class),
				@ColumnResult(name = "GB_out", type = String.class),
				@ColumnResult(name = "GB_total", type = String.class),
				@ColumnResult(name = "userdevice", type = String.class),
				@ColumnResult(name = "deviceno", type = String.class),
				@ColumnResult(name = "fromip", type = String.class),
				@ColumnResult(name = "framedipaddress", type = String.class)}) })

//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAll", query = "SELECT DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen, if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false) as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate  FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username  LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 ORDER BY ui.creationdate ", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllFtdate", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false) as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate  FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username    LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 and date(ui.creationdate)>=:fdate and date(ui.creationdate)<=:tdate  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllByOpid", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username  LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username  LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=?1  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusAllByOpidFtdate", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.usernameLEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=:opid and date(ui.creationdate)>=:fdate and date(ui.creationdate)<=:tdate ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNotExp", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen, if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid>0  ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNotExpByOpid", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOffline", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ra.username=ui.username and ui.is_delete=0 and ustatus is null and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOfflineByOpid", query = "SELECT  DISTINCT ui.id,if(ui.isiptv,'Active','Deactive') AS isiptv,(SELECT if(planDiscountDays IS NULL,0,planDiscountDays) AS planDiscountDays FROM quotaplanlcoprices WHERE opid=0 AND subplanId=ubi.planid) AS discountDays,if(ra3.acctstoptime is null,'',ra3.acctstoptime) lastseen,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN (SELECT radacctid,username,MAX(acctstarttime),MAX(acctstoptime) as acctstoptime,acctterminatecause FROM radacct WHERE acctstoptime IS NOT NULL AND username NOT IN(SELECT username FROM radacct WHERE acctstoptime IS NULL) GROUP BY username) ra3 ON ra3.username=ra.username   LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ustatus is null and ui.opid=?1 AND ra.username=ui.username ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListRS")
//@SqlResultSetMapping(name = "Mapping.UserListRS", classes = {
//		@ConstructorResult(targetClass = UserListDTO.class, columns = { @ColumnResult(name = "id"),
//				@ColumnResult(name = "planid", type = Integer.class), @ColumnResult(name = "quotaexpirydate"),
//				@ColumnResult(name = "fullname"), @ColumnResult(name = "username"), @ColumnResult(name = "password"),
//				@ColumnResult(name = "email"), @ColumnResult(name = "mobilephone"), @ColumnResult(name = "mac"),
//				@ColumnResult(name = "ip"), @ColumnResult(name = "nasip"),
//				@ColumnResult(name = "upload", type = BigInteger.class),
//				@ColumnResult(name = "download", type = BigInteger.class), @ColumnResult(name = "planName"),
//				@ColumnResult(name = "ustatus"), @ColumnResult(name = "verificationstatus"),
//				@ColumnResult(name = "expstatus", type = Boolean.class), @ColumnResult(name = "quotastartdate"),
//				@ColumnResult(name = "lconame"), @ColumnResult(name = "lcoid", type = Integer.class),
//				@ColumnResult(name = "vlanid", type = Integer.class), @ColumnResult(name = "planDays"),
//				@ColumnResult(name = "isott", type = String.class),
//				@ColumnResult(name = "ottplanActive", type = boolean.class), @ColumnResult(name = "ottplanexpirydate"),
//				@ColumnResult(name = "ottplanactivedate"), @ColumnResult(name = "poolType"),
//				@ColumnResult(name = "lastseen", type = String.class),
//				@ColumnResult(name = "discountDays", type = String.class),
//				@ColumnResult(name = "isiptv", type = String.class) }) })

@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusExp", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate<=now() and ui.is_delete=0 and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusExpByOpid", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,ubi.planid,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ubi.quotaexpirydate<=now() and ui.is_delete=0 and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOnline", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ui.is_delete=0 and ustatus='Online' and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusOnlineByOpid", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus  FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ubi.quotaexpirydate>now() and ui.is_delete=0 and ustatus='Online' and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusUnderverif", query = "SELECT  DISTINCT ui.id.if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus , concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus  FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus=1 and ui.is_delete=0 and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusUnVerfByOpid", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus , concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.is_delete=0 and verificationstatus=1 and  ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNew", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'New',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus=0 and ui.is_delete=0 and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusNewByOpid", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'New',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE verificationstatus=0 and ui.is_delete=0 and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusDelete", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE  ui.is_delete=1 and ui.opid>0 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusDeleteByOpid", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.is_delete=1 and ui.opid=?1 ORDER BY ui.creationdate", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusPlanWise", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid>0 ORDER BY planid asc", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusPlanWiseByOpid", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,'Offline',ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.verificationstatus>0 and ubi.quotaexpirydate>now() and ui.is_delete=0 and ui.opid=?1 order by planid asc", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusMaxDataUserAll", query = "SELECT  DISTINCT ui.id,if(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott ,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE  ui.is_delete=0 and ui.opid>0 ORDER BY ra1.download DESC", resultSetMapping = "Mapping.UserListDTO")
@NamedNativeQuery(name = "Userinfo.gatUserListWithCurrentStatusMaxDataUserByOpid", query = "SELECT  iDISTINCT ui.id,f(rp.username is not null,concat(rp.pool_name,'(',rp.framedipaddress,')'),if(ui.verificationstatus=2,if(ui.iptype is not null,ui.iptype,' '),' ')) AS poolType,ui.id,if(ubi.quotaexpirydate>now(),false,true) AS expstatus,ubi.planid,if(ubi.quotastartdate is null,'',ubi.quotastartdate) as quotastartdate,if(ubi.quotaexpirydate is null,'',ubi.quotaexpirydate) as quotaexpirydate,ui.username AS username,ui.password AS password,concat(ui.firstname,' ',ui.lastname) as fullname,ui.email,ui.mobilephone,ui.verificationstatus,ubi.planName,ra.callingstationid AS mac,ra.framedipaddress AS ip,ra.nasipaddress AS nasip,if(ra1.upload is null,0,ra1.upload)as upload,if(ra1.download is null,0,ra1.download)as download,if(ra2.ustatus is null,if(ui.verificationstatus=0,'New',if(ubi.quotaexpirydate<now(),'Expiry','Offline')),ra2.ustatus) AS ustatus, concat(op.firstname,' ',op.lastname)as lconame,op.id as lcoid,op.vlanid,(SELECT planTimeBank FROM quotasubplan WHERE id=ubi.planid)AS planDays,if(oui.username is null,'Deactive','Active')AS isott,if(oui.planexpirydate>now(),true,false)as ottplanActive,if(oui.planexpirydate is null,' ',oui.planexpirydate) AS ottplanexpirydate,if(oui.planstartdate is null,' ',oui.planstartdate) AS ottplanactivedate FROM (SELECT username AS un,sum(acctinputoctets) as upload,sum(acctoutputoctets) download,max(UNIX_TIMESTAMP(acctstarttime)) AS ast FROM radacct GROUP BY username) ra1 JOIN radacct ra ON UNIX_TIMESTAMP(ra.acctstarttime)=ra1.ast and username=ra1.un RIGHT JOIN userinfo ui ON ui.username=ra1.un LEFT JOIN radcheck rc ON rc.attribute='Cleartext-Password' and rc.username=ui.username JOIN userbillinfo ubi ON ubi.username=ui.username LEFT JOIN (SELECT username,if(COUNT(username)>=1,'Online','Offline') AS ustatus FROM radacct WHERE AcctStopTime IS NULL GROUP BY username) AS ra2 ON ui.username=ra2.username LEFT JOIN operators op ON op.id=ui.opid LEFT JOIN (SELECT * FROM ottuserinfo WHERE isactive=1) AS  oui ON oui.username=ui.username LEFT JOIN radippool rp ON rp.username=ui.username  WHERE ui.is_delete=0 and ui.opid=?1 ORDER BY ra1.download DESC", resultSetMapping = "Mapping.UserListDTO")
@SqlResultSetMapping(name = "Mapping.UserListDTO", classes = {
		@ConstructorResult(targetClass = UserListDTO.class, columns = { @ColumnResult(name = "id"),
				@ColumnResult(name = "planid", type = Integer.class), @ColumnResult(name = "quotaexpirydate"),
				@ColumnResult(name = "fullname"), @ColumnResult(name = "username"), @ColumnResult(name = "password"),
				@ColumnResult(name = "email"), @ColumnResult(name = "mobilephone"), @ColumnResult(name = "mac"),
				@ColumnResult(name = "ip"), @ColumnResult(name = "nasip"),
				@ColumnResult(name = "upload", type = BigInteger.class),
				@ColumnResult(name = "download", type = BigInteger.class), @ColumnResult(name = "planName"),
				@ColumnResult(name = "ustatus"), @ColumnResult(name = "verificationstatus"),
				@ColumnResult(name = "expstatus", type = Boolean.class), @ColumnResult(name = "quotastartdate"),
				@ColumnResult(name = "lconame"), @ColumnResult(name = "lcoid", type = Integer.class),
				@ColumnResult(name = "vlanid", type = Integer.class), @ColumnResult(name = "planDays"),
				@ColumnResult(name = "isott", type = String.class),
				@ColumnResult(name = "ottplanActive", type = boolean.class), @ColumnResult(name = "ottplanexpirydate"),
				@ColumnResult(name = "ottplanactivedate"), @ColumnResult(name = "poolType") }) })

@NamedNativeQuery(name = "Userinfo.getUserStatusAll", query = "SELECT ui.username,if(ubi.quotaexpirydate>=now(),'Active',if(ubi.quotaexpirydate is null,'New','Deactive'))AS status FROM userinfo ui INNER JOIN userbillinfo ubi ON ubi.username=ui.username WHERE ui.opid=(SELECT id FROM operators WHERE username=:username) AND ui.is_delete=0", resultSetMapping = "Mapping.userStatusDTO")
@NamedNativeQuery(name = "Userinfo.getUserStatusActive", query = "SELECT ui.username,if(ubi.quotaexpirydate>=now(),'Active','Deactive')AS status FROM userinfo ui INNER JOIN userbillinfo ubi ON ubi.username=ui.username WHERE ui.opid=(SELECT id FROM operators WHERE username=:username) and quotaexpirydate>=:t1 AND ui.is_delete=0", resultSetMapping = "Mapping.userStatusDTO")
@NamedNativeQuery(name = "Userinfo.getUserStatusDeactive", query = "SELECT ui.username,if(ubi.quotaexpirydate>=now(),'Active','Deactive')AS status FROM userinfo ui INNER JOIN userbillinfo ubi ON ubi.username=ui.username WHERE ui.opid=(SELECT id FROM operators WHERE username=:username) and quotaexpirydate<:t1 AND ui.is_delete=0", resultSetMapping = "Mapping.userStatusDTO")
@NamedNativeQuery(name = "Userinfo.getUserStatusNew", query = "SELECT ui.username,if(ubi.quotaexpirydate is null,'new','false')AS status FROM userinfo ui INNER JOIN userbillinfo ubi ON ubi.username=ui.username WHERE ui.opid=(SELECT id FROM operators WHERE username=:username) AND ubi.quotaexpirydate is null AND ui.is_delete=0", resultSetMapping = "Mapping.userStatusDTO")
@SqlResultSetMapping(name = "Mapping.userStatusDTO", classes = {
		@ConstructorResult(targetClass = UserStatusDTO.class, columns = { @ColumnResult(name = "username"),
				@ColumnResult(name = "status", type = String.class) }) })

@NamedNativeQuery(name = "Userinfo.mvusersms", query = "SELECT ui.id,DATE_FORMAT(ubi.quotaexpirydate,'%D %M %Y') AS quotaexpirydate,CONCAT(ui.firstname,' ',ui.lastname)AS cusfullname,ui.username,ui.password,ui.email,ui.mobilephone,ubi.planName,CONCAT(op.firstname,' ' ,op.lastname)AS lconame,ui.opid,op.phone1 as opmobile  FROM userbillinfo ubi,userinfo ui,operators op WHERE ui.username=ubi.username AND op.id=ui.opid AND DATE(quotaexpirydate)<='2022-12-18' AND ui.is_delete=0", resultSetMapping = "Mapping.getTrwExpiryUserDetailsRS")

@NamedNativeQuery(name = "Userinfo.getExpiryUserDetailsBefore", query = "SELECT ubi.planid,ui.id,DATE_FORMAT(ubi.quotaexpirydate,'%d-%M-%Y') AS quotaexpirydate,CONCAT(ui.firstname,' ',ui.lastname)AS cusfullname,ui.username,ui.password,ui.email,ui.mobilephone,ubi.planName,CONCAT(op.firstname,' ' ,op.lastname)AS lconame,ui.opid,op.phone1 as opmobile  FROM userbillinfo ubi,userinfo ui,(select*from operators where username not in('mssatvision')) op WHERE ui.username=ubi.username AND op.id=ui.opid AND DATE(quotaexpirydate)=(CURDATE()+INTERVAL :day DAY) AND ui.is_delete=0", resultSetMapping = "Mapping.getTrwExpiryUserDetailsRS")
@NamedNativeQuery(name = "Userinfo.getExpiryUserDetailsAfter", query = "SELECT ubi.planid,ui.id,DATE_FORMAT(ubi.quotaexpirydate,'%d-%M-%Y') AS quotaexpirydate,CONCAT(ui.firstname,' ',ui.lastname)AS cusfullname,ui.username,ui.password,ui.email,ui.mobilephone,ubi.planName,CONCAT(op.firstname,' ' ,op.lastname)AS lconame,ui.opid,op.phone1 as opmobile  FROM userbillinfo ubi,userinfo ui,(select*from operators where username not in('mssatvision')) op WHERE ui.username=ubi.username AND op.id=ui.opid AND DATE(quotaexpirydate)=(CURDATE()-INTERVAL :day DAY) AND ui.is_delete=0", resultSetMapping = "Mapping.getTrwExpiryUserDetailsRS")
@NamedNativeQuery(name = "Userinfo.getTodayRechargedUserDetails", query = "SELECT ubi.planid,ui.id,DATE_FORMAT(ubi.quotaexpirydate,'%d-%M-%Y') AS quotaexpirydate,CONCAT(ui.firstname,' ',ui.lastname)AS cusfullname,ui.username,ui.password,ui.email,ui.mobilephone,ubi.planName,CONCAT(op.firstname,' ' ,op.lastname)AS lconame,ui.opid,op.phone1 as opmobile  FROM userbillinfo ubi,userinfo ui,operators op WHERE ui.username=ubi.username AND op.id=ui.opid AND DATE(quotastartdate)=CURDATE() AND ui.is_delete=0", resultSetMapping = "Mapping.getTrwExpiryUserDetailsRS")
@NamedNativeQuery(name = "Userinfo.getUserDetailtByUsername", query = "SELECT ubi.planid,ubi.id,DATE_FORMAT(ubi.quotaexpirydate,'%D %M %Y') AS quotaexpirydate,' ' AS cusfullname,ubi.username,' 'as password,'' as email,'' as mobilephone,ubi.planName,' ' AS lconame,0 as opid,'' as opmobile  FROM userbillinfo ubi WHERE username=:username", resultSetMapping = "Mapping.getTrwExpiryUserDetailsRS")
@SqlResultSetMapping(name = "Mapping.getTrwExpiryUserDetailsRS", classes = {
		@ConstructorResult(targetClass = UserListDTO.class, columns = {
				@ColumnResult(name = "id", type = Integer.class),
				@ColumnResult(name = "quotaexpirydate", type = String.class), @ColumnResult(name = "cusfullname"),
				@ColumnResult(name = "username"), @ColumnResult(name = "password", type = String.class),
				@ColumnResult(name = "email"), @ColumnResult(name = "mobilephone", type = String.class),
				@ColumnResult(name = "planName"), @ColumnResult(name = "lconame"),
				@ColumnResult(name = "opid", type = Integer.class),
				@ColumnResult(name = "opmobile", type = String.class), @ColumnResult(name = "planid") }) })

@NamedNativeQuery(name = "Userinfo.getExpiredUserForSMS", query = "SELECT ubi.username,ui.id,CONCAT(ui.firstname,' ',ui.lastname)AS name FROM userbillinfo ubi,userinfo ui,operators op WHERE ui.username=ubi.username AND op.id=ui.opid AND DATE(ubi.quotaexpirydate)>=(CURDATE()-INTERVAL 3 DAY) AND DATE(ubi.quotaexpirydate)<curdate() AND ui.is_delete=0 AND op.username=:username", resultSetMapping = "Mapping.getExpiredUserForSMSRS")
@NamedNativeQuery(name = "Userinfo.getExpiringUserForSMS", query = "SELECT ubi.username,ui.id,CONCAT(ui.firstname,' ',ui.lastname)AS name  FROM userbillinfo ubi,userinfo ui,operators op WHERE ui.username=ubi.username AND op.id=ui.opid AND DATE(ubi.quotaexpirydate)>=curdate() AND DATE(ubi.quotaexpirydate)<=(curdate()+INTERVAL 3 DAY) AND op.username=:username", resultSetMapping = "Mapping.getExpiredUserForSMSRS")
@NamedNativeQuery(name = "Userinfo.getRenewalUserForSMS", query = "SELECT ubi.username,ui.id,CONCAT(ui.firstname,' ',ui.lastname)AS name  FROM userbillinfo ubi,userinfo ui,quotaplanmanagelog qpl,operators op WHERE ui.username=ubi.username AND qpl.username=ubi.username AND op.id=ui.opid  AND DATE(qpl.creationdate)>=(curdate()-INTERVAL 3 DAY) AND DATE(qpl.creationdate)<=curdate() AND op.username=:username", resultSetMapping = "Mapping.getExpiredUserForSMSRS")
@NamedNativeQuery(name = "Userinfo.getNewActiveUserForSMS", query = "SELECT ubi.username,ui.id,CONCAT(ui.firstname,' ',ui.lastname)AS name  FROM userbillinfo ubi,userinfo ui,quotaplanmanagelog qpl,operators op,(SELECT COUNT(id) AS count,username FROM quotaplanmanagelog GROUP BY username) qpl2 WHERE ui.username=ubi.username AND qpl.username=ubi.username AND op.id=ui.opid  AND DATE(qpl.creationdate)>=(curdate()-INTERVAL 3 DAY) AND DATE(qpl.creationdate)<=curdate() AND qpl2.username=ubi.username AND qpl2.count=1  AND op.username=:username", resultSetMapping = "Mapping.getExpiredUserForSMSRS")
@NamedNativeQuery(name = "Userinfo.getAllUserForSMS", query = "SELECT ui.username,ui.id,CONCAT(ui.firstname,' ',ui.lastname)AS name  FROM userinfo ui,operators op where op.id=ui.opid AND ui.is_delete=0 AND op.username=:username", resultSetMapping = "Mapping.getExpiredUserForSMSRS")
@SqlResultSetMapping(name = "Mapping.getExpiredUserForSMSRS", classes = {
		@ConstructorResult(targetClass = Userinfo.class, columns = { @ColumnResult(name = "id", type = Integer.class),
				@ColumnResult(name = "username"), @ColumnResult(name = "name", type = String.class) }) })

public class Userinfo {
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private int id;

//	@NotNull(message = "username has to be present")
//	@Size(min = 6, max = 10, message = "The username '${validatedValue}' must be between {min} and {max} characters long")
	@NotNull
	private String username;

//	@NotNull(message = "password has to be present")
//	@Size(min = 6, max = 10, message = "The password '${validatedValue}' must be between {min} and {max} characters long")
	@NotNull
	private String password;

	private String firstname;
	private String lastname;

	@Email(message = "Please enter valid email", regexp = "^[a-zA-Z0-9._-]+@[a-zA-Z0-9-]+\\.[a-zA-Z.]{2,5}")
	@NotEmpty(message = "Email cannot be empty")
	private String email;

	private String department;
	private String company;
	private String workphone;
	private String homephone;
	private String mobilephone;
	private String address;
	private String city;
	private String state;
	private String country;
	private String zip;
	private String notes;
	private String walletbalance;
	private String changeuserinfo;
	private String portalloginpassword;
	private int enableportallogin;
	private int verificationstatus;
	private int vlanid;

	@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
	private String creationdate;

	@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
	private String updatedate;

	private String creationby;
	private String updateby;
	private int opid;

	private String userproofimage1;

	private String olttype;
	private String ponout;
	private String userdevice;
	private String deviceno;
	private String macaddress;
	private boolean is_active;
	private boolean is_delete;
	private String gstin;
	private String iptype;
	private boolean isiptv;

	public Userinfo() {

	}

	public Userinfo(String username, String password, String firstname, String lastname, String email,
			String department, String company, String workphone, String homephone, String mobilephone, String address,
			String city, String state, String country, String zip, String notes, String walletbalance,
			String changeuserinfo, String portalloginpassword, int enableportallogin, String creationby,
			String updateby, int opid, int verificationstatus, String userproofimage1, String olttype, String ponout,
			String userdevice, String macaddress, int vlanid, String gstin, String iptype) {
		super();
		this.username = username;
		this.password = password;
		this.firstname = firstname;
		this.lastname = lastname;
		this.email = email;
		this.department = department;
		this.company = company;
		this.workphone = workphone;
		this.homephone = homephone;
		this.mobilephone = mobilephone;
		this.address = address;
		this.city = city;
		this.state = state;
		this.country = country;
		this.zip = zip;
		this.notes = notes;
		this.walletbalance = walletbalance;
		this.changeuserinfo = changeuserinfo;
		this.portalloginpassword = portalloginpassword;
		this.enableportallogin = enableportallogin;
		this.creationby = creationby;
		this.updateby = updateby;
		this.opid = opid;
		this.verificationstatus = verificationstatus;
		this.userproofimage1 = userproofimage1;
		this.olttype = olttype;
		this.ponout = ponout;
		this.userdevice = userdevice;
		this.macaddress = macaddress;
		this.vlanid = vlanid;
		this.gstin = gstin;
	}

	public Userinfo(int id, @NotNull String username, String firstname) {
		super();
		this.id = id;
		this.username = username;
		this.firstname = firstname;
	}

	public String getIptype() {
		return iptype;
	}

	public void setIptype(String iptype) {
		this.iptype = iptype;
	}

	public String getGstin() {
		return gstin;
	}

	public void setGstin(String gstin) {
		this.gstin = gstin;
	}

	public int getVlanid() {
		return vlanid;
	}

	public void setVlanid(int vlanid) {
		this.vlanid = vlanid;
	}

	public int getId() {
		return id;
	}

	public void setId(int id) {
		this.id = id;
	}

	public String getUsername() {
		return username;
	}

	public void setUsername(String username) {
		this.username = username;
	}

	public String getPassword() {
		return password;
	}

	public void setPassword(String password) {
		this.password = password;
	}

	public String getFirstname() {
		return firstname;
	}

	public void setFirstname(String firstname) {
		this.firstname = firstname;
	}

	public String getLastname() {
		return lastname;
	}

	public void setLastname(String lastname) {
		this.lastname = lastname;
	}

	public String getEmail() {
		return email;
	}

	public void setEmail(String email) {
		this.email = email;
	}

	public String getDepartment() {
		return department;
	}

	public void setDepartment(String department) {
		this.department = department;
	}

	public String getCompany() {
		return company;
	}

	public void setCompany(String company) {
		this.company = company;
	}

	public String getWorkphone() {
		return workphone;
	}

	public void setWorkphone(String workphone) {
		this.workphone = workphone;
	}

	public String getHomephone() {
		return homephone;
	}

	public void setHomephone(String homephone) {
		this.homephone = homephone;
	}

	public String getMobilephone() {
		return mobilephone;
	}

	public void setMobilephone(String mobilephone) {
		this.mobilephone = mobilephone;
	}

	public String getAddress() {
		return address;
	}

	public void setAddress(String address) {
		this.address = address;
	}

	public String getCity() {
		return city;
	}

	public void setCity(String city) {
		this.city = city;
	}

	public String getState() {
		return state;
	}

	public void setState(String state) {
		this.state = state;
	}

	public String getCountry() {
		return country;
	}

	public void setCountry(String country) {
		this.country = country;
	}

	public String getZip() {
		return zip;
	}

	public void setZip(String zip) {
		this.zip = zip;
	}

	public String getNotes() {
		return notes;
	}

	public void setNotes(String notes) {
		this.notes = notes;
	}

	public String getWalletbalance() {
		return walletbalance;
	}

	public void setWalletbalance(String walletbalance) {
		this.walletbalance = walletbalance;
	}

	public String getChangeuserinfo() {
		return changeuserinfo;
	}

	public void setChangeuserinfo(String changeuserinfo) {
		this.changeuserinfo = changeuserinfo;
	}

	public String getPortalloginpassword() {
		return portalloginpassword;
	}

	public void setPortalloginpassword(String portalloginpassword) {
		this.portalloginpassword = portalloginpassword;
	}

	public int getEnableportallogin() {
		return enableportallogin;
	}

	public void setEnableportallogin(int enableportallogin) {
		this.enableportallogin = enableportallogin;
	}

	public String getCreationdate() {
		return creationdate;
	}

	public void setCreationdate(String creationdate) {
		this.creationdate = creationdate;
	}

	public String getUpdatedate() {
		return updatedate;
	}

	public void setUpdatedate(String updatedate) {
		this.updatedate = updatedate;
	}

	public String getCreationby() {
		return creationby;
	}

	public void setCreationby(String creationby) {
		this.creationby = creationby;
	}

	public String getUpdateby() {
		return updateby;
	}

	public void setUpdateby(String updateby) {
		this.updateby = updateby;
	}

	public int getOpid() {
		return opid;
	}

	public void setOpid(int opid) {
		this.opid = opid;
	}

	public int getVerificationstatus() {
		return verificationstatus;
	}

	public void setVerificationstatus(int verificationstatus) {
		this.verificationstatus = verificationstatus;
	}

	public String getUserproofimage1() {
		return userproofimage1;
	}

	public void setUserproofimage1(String userproofimage1) {
		this.userproofimage1 = userproofimage1;
	}

	public String getOlttype() {
		return olttype;
	}

	public void setOlttype(String olttype) {
		this.olttype = olttype;
	}

	public String getPonout() {
		return ponout;
	}

	public void setPonout(String ponout) {
		this.ponout = ponout;
	}

	public String getUserdevice() {
		return userdevice;
	}

	public void setUserdevice(String userdevice) {
		this.userdevice = userdevice;
	}

	public String getMacaddress() {
		return macaddress;
	}

	public void setMacaddress(String macaddress) {
		this.macaddress = macaddress;
	}

	public boolean isIs_active() {
		return is_active;
	}

	public void setIs_active(boolean is_active) {
		this.is_active = is_active;
	}

	public boolean isIs_delete() {
		return is_delete;
	}

	public void setIs_delete(boolean is_delete) {
		this.is_delete = is_delete;
	}

	public boolean isIsiptv() {
		return isiptv;
	}

	public void setIsiptv(boolean isiptv) {
		this.isiptv = isiptv;
	}

	public String getDeviceno() {
		return deviceno;
	}

	public void setDeviceno(String deviceno) {
		this.deviceno = deviceno;
	}

}
